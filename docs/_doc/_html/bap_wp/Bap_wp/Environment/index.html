<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Environment (bap_wp.Bap_wp.Environment)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">bap_wp</a> &#x00BB; <a href="../index.html">Bap_wp</a> &#x00BB; Environment</nav><h1>Module <code>Bap_wp.Environment</code></h1></header><aside><p>This module represents the environment of a BIR program and is used when determining pre-conditions.</p><p>It contains a Z3 context, a <a href="index.html#type-var_gen"><code>var_gen</code></a>, the association between BIR variables and Z3 constants, preconditions for previously visited blocks, a mapping of Z3 variables to function calls during runtime, subroutine summaries, a handler for loop unrolling, and expression verification conditions.</p></aside><div class="spec module" id="module-EnvMap"><a href="#module-EnvMap" class="anchor"></a><code><span class="keyword">module</span> EnvMap = Bap.Std.Var.Map</code></div><div class="spec module" id="module-Constr"><a href="#module-Constr" class="anchor"></a><code><span class="keyword">module</span> Constr = <a href="../index.html#module-Constraint">Constraint</a></code></div><div class="spec module" id="module-ExprSet"><a href="#module-ExprSet" class="anchor"></a><code><span class="keyword">module</span> ExprSet : Core_kernel.Set.S <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#module-ExprSet">ExprSet</a>.Elt.t = <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></div><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The state type which is maintained when creating preconditions. It contains, among other things, summaries for subroutines, the associations between BIR variables and Z3 constants, and preconditions for already visited blocks, if relevant.</p></dd></dl><dl><dt class="spec type" id="type-var_gen"><a href="#type-var_gen" class="anchor"></a><code><span class="keyword">type</span> var_gen</code></dt><dd><p>This type is used to create fresh variables when needed. It's internals should be irrelevant.</p></dd></dl><dl><dt class="spec type" id="type-fun_spec_type"><a href="#type-fun_spec_type" class="anchor"></a><code><span class="keyword">type</span> fun_spec_type</code><code> = </code><table class="variant"><tr id="type-fun_spec_type.Summary" class="anchored"><td class="def constructor"><a href="#type-fun_spec_type.Summary" class="anchor"></a><code>| </code><code><span class="constructor">Summary</span> <span class="keyword">of</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> * <a href="index.html#type-t">t</a></code></td></tr><tr id="type-fun_spec_type.Inline" class="anchored"><td class="def constructor"><a href="#type-fun_spec_type.Inline" class="anchor"></a><code>| </code><code><span class="constructor">Inline</span></code></td></tr></table></dt><dd><p>The type that specifies whether a fun_spec should calculate the precondition based off a summary or by inlining the function and visiting it with <a href="../Precondition/index.html#val-visit_sub"><code>Precondition.visit_sub</code></a>.</p></dd></dl><dl><dt class="spec type" id="type-fun_spec"><a href="#type-fun_spec" class="anchor"></a><code><span class="keyword">type</span> fun_spec</code><code> = </code><code>{</code><table class="record"><tr id="type-fun_spec.spec_name" class="anchored"><td class="def field"><a href="#type-fun_spec.spec_name" class="anchor"></a><code>spec_name : string;</code></td></tr><tr id="type-fun_spec.spec" class="anchored"><td class="def field"><a href="#type-fun_spec.spec" class="anchor"></a><code>spec : <a href="index.html#type-fun_spec_type">fun_spec_type</a>;</code></td></tr></table><code>}</code></dt><dd><p>Type that specifies what rules should be used when calculating the precondition of a subroutine.</p></dd></dl><dl><dt class="spec type" id="type-indirect_spec"><a href="#type-indirect_spec" class="anchor"></a><code><span class="keyword">type</span> indirect_spec</code><code> = <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> Bap.Std.Exp.t <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> * <a href="index.html#type-t">t</a></code></dt><dd><p>Type that specifies what rules should be used when encountering an indirect call</p></dd></dl><dl><dt class="spec type" id="type-jmp_spec"><a href="#type-jmp_spec" class="anchor"></a><code><span class="keyword">type</span> jmp_spec</code><code> = <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> Bap.Std.Jmp.t <span>&#45;&gt;</span> <span><span>(<a href="../Constraint/index.html#type-t">Constr.t</a> * <a href="index.html#type-t">t</a>)</span> option</span></code></dt><dd><p>Type that specifies what rules should be used when visiting a jump in a BIR program.</p></dd></dl><dl><dt class="spec type" id="type-int_spec"><a href="#type-int_spec" class="anchor"></a><code><span class="keyword">type</span> int_spec</code><code> = <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> * <a href="index.html#type-t">t</a></code></dt><dd><p>Type that specifies what rules should be used when calculating the precondition of an interrupt.</p></dd></dl><dl><dt class="spec type" id="type-loop_handler"><a href="#type-loop_handler" class="anchor"></a><code><span class="keyword">type</span> loop_handler</code><code> = </code><code>{</code><table class="record"><tr id="type-loop_handler.handle" class="anchored"><td class="def field"><a href="#type-loop_handler.handle" class="anchor"></a><code>handle : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> <span>start:Bap.Std.Graphs.Ir.Node.t</span> <span>&#45;&gt;</span> Bap.Std.Graphs.Ir.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>;</code></td></tr></table><code>}</code></dt><dd><p>The loop handling procedure for the appropriate blocks.</p></dd></dl><dl><dt class="spec type" id="type-cond"><a href="#type-cond" class="anchor"></a><code><span class="keyword">type</span> cond</code><code> = </code><table class="variant"><tr id="type-cond.BeforeExec" class="anchored"><td class="def constructor"><a href="#type-cond.BeforeExec" class="anchor"></a><code>| </code><code><span class="constructor">BeforeExec</span> <span class="keyword">of</span> <a href="../Constraint/index.html#type-goal">Constr.goal</a></code></td></tr><tr id="type-cond.AfterExec" class="anchored"><td class="def constructor"><a href="#type-cond.AfterExec" class="anchor"></a><code>| </code><code><span class="constructor">AfterExec</span> <span class="keyword">of</span> <a href="../Constraint/index.html#type-goal">Constr.goal</a></code></td></tr></table></dt><dd><p>Condition generated when exploring an expression: <code>BeforeExec</code> will generate a <a href="../Constraint/index.html#type-goal"><code>Constr.goal</code></a> to be added to the postcondition before any substitution is made, and <code>AfterExec</code> will generate the goal to be added after all substitutions are completed.</p></dd></dl><dl><dt class="spec type" id="type-cond_type"><a href="#type-cond_type" class="anchor"></a><code><span class="keyword">type</span> cond_type</code><code> = </code><table class="variant"><tr id="type-cond_type.Verify" class="anchored"><td class="def constructor"><a href="#type-cond_type.Verify" class="anchor"></a><code>| </code><code><span class="constructor">Verify</span> <span class="keyword">of</span> <a href="index.html#type-cond">cond</a></code></td></tr><tr id="type-cond_type.Assume" class="anchored"><td class="def constructor"><a href="#type-cond_type.Assume" class="anchor"></a><code>| </code><code><span class="constructor">Assume</span> <span class="keyword">of</span> <a href="index.html#type-cond">cond</a></code></td></tr></table></dt><dd><p>Conditions generated when exploring an expression: if it is a <code>Verify</code>, this represents an additional proof obligation, an <code>Assume</code> represents an assumption, typically about the definedness of the expression.</p></dd></dl><dl><dt class="spec type" id="type-exp_cond"><a href="#type-exp_cond" class="anchor"></a><code><span class="keyword">type</span> exp_cond</code><code> = <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Exp.t <span>&#45;&gt;</span> <span><a href="index.html#type-cond_type">cond_type</a> option</span></code></dt><dd><p>Type that generates a Verification Condition on encountering a given pattern, typically a correctness constraint, like no overflow or no null dereference.</p></dd></dl><dl><dt class="spec type" id="type-mem_range"><a href="#type-mem_range" class="anchor"></a><code><span class="keyword">type</span> mem_range</code><code> = </code><code>{</code><table class="record"><tr id="type-mem_range.base_addr" class="anchored"><td class="def field"><a href="#type-mem_range.base_addr" class="anchor"></a><code>base_addr : int;</code></td></tr><tr id="type-mem_range.size" class="anchored"><td class="def field"><a href="#type-mem_range.size" class="anchor"></a><code>size : int;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-mk_env"><a href="#val-mk_env" class="anchor"></a><code><span class="keyword">val</span> mk_env : <span>subs:<span>Bap.Std.Sub.t Bap.Std.Seq.t</span></span> <span>&#45;&gt;</span> <span>specs:<span><span>(Bap.Std.Sub.t <span>&#45;&gt;</span> Bap.Std.Arch.t <span>&#45;&gt;</span> <span><a href="index.html#type-fun_spec">fun_spec</a> option</span>)</span> list</span></span> <span>&#45;&gt;</span> <span>default_spec:<span>(Bap.Std.Sub.t <span>&#45;&gt;</span> Bap.Std.Arch.t <span>&#45;&gt;</span> <a href="index.html#type-fun_spec">fun_spec</a>)</span></span> <span>&#45;&gt;</span> <span>indirect_spec:<a href="index.html#type-indirect_spec">indirect_spec</a></span> <span>&#45;&gt;</span> <span>jmp_spec:<a href="index.html#type-jmp_spec">jmp_spec</a></span> <span>&#45;&gt;</span> <span>int_spec:<a href="index.html#type-int_spec">int_spec</a></span> <span>&#45;&gt;</span> <span>exp_conds:<span><a href="index.html#type-exp_cond">exp_cond</a> list</span></span> <span>&#45;&gt;</span> <span>num_loop_unroll:int</span> <span>&#45;&gt;</span> <span>arch:Bap.Std.Arch.t</span> <span>&#45;&gt;</span> <span>freshen_vars:bool</span> <span>&#45;&gt;</span> <span>use_fun_input_regs:bool</span> <span>&#45;&gt;</span> <span>stack_range:<a href="index.html#type-mem_range">mem_range</a></span> <span>&#45;&gt;</span> <span>data_section_range:<a href="index.html#type-mem_range">mem_range</a></span> <span>&#45;&gt;</span> Z3.context <span>&#45;&gt;</span> <a href="index.html#type-var_gen">var_gen</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Creates a new environment with</p><ul><li>a sequence of subroutines in the program used to initialize function specs</li><li>a list of <a href="index.html#type-fun_spec"><code>fun_spec</code></a>s that each summarize the precondition for its mapped function</li><li>the default fun_spec in the case a function does not satisfy the requirements of the other fun_specs</li><li>a <a href="index.html#type-indirect_spec"><code>indirect_spec</code></a> for handling indirect calls</li><li>a <a href="index.html#type-jmp_spec"><code>jmp_spec</code></a> for handling branches</li><li>an <a href="index.html#type-int_spec"><code>int_spec</code></a> for handling interrupts</li><li>a list of <a href="index.html#type-exp_cond"><code>exp_cond</code></a>s to satisfy</li><li>the number of times to unroll a loop</li><li>the architecture of the binary</li><li>the option to freshen variable names</li><li>the option to use all input registers when generating function symbols at a call site</li><li>the concrete range of addresses of the stack</li><li>the concrete range of addresses of the data section</li><li>a Z3 context</li><li>and a variable generator.</li></ul></dd></dl><dl><dt class="spec value" id="val-env_to_string"><a href="#val-env_to_string" class="anchor"></a><code><span class="keyword">val</span> env_to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Creates a string representation of the environment.</p></dd></dl><dl><dt class="spec value" id="val-mk_ctx"><a href="#val-mk_ctx" class="anchor"></a><code><span class="keyword">val</span> mk_ctx : unit <span>&#45;&gt;</span> Z3.context</code></dt><dd><p>Create a Z3 context, used to generate every Z3 expression. Simply defined as <code>Z3.mk_context []</code>.</p></dd></dl><dl><dt class="spec value" id="val-mk_var_gen"><a href="#val-mk_var_gen" class="anchor"></a><code><span class="keyword">val</span> mk_var_gen : unit <span>&#45;&gt;</span> <a href="index.html#type-var_gen">var_gen</a></code></dt><dd><p>Create a new variable generator. Two fresh variables created with the same generator will be distinct.</p></dd></dl><dl><dt class="spec value" id="val-get_fresh"><a href="#val-get_fresh" class="anchor"></a><code><span class="keyword">val</span> get_fresh : <span>?&#8288;name:string</span> <span>&#45;&gt;</span> <a href="index.html#type-var_gen">var_gen</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get a fresh variable name, possibly prefixed by a given <code>name</code> string.</p></dd></dl><dl><dt class="spec value" id="val-set_freshen"><a href="#val-set_freshen" class="anchor"></a><code><span class="keyword">val</span> set_freshen : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Set variable freshening, which will cause constraint generation to create fresh variables.</p></dd></dl><dl><dt class="spec value" id="val-add_const"><a href="#val-add_const" class="anchor"></a><code><span class="keyword">val</span> add_const : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Add a z3 expression representing a constant generated during the analysis to the environment.</p></dd></dl><dl><dt class="spec value" id="val-clear_consts"><a href="#val-clear_consts" class="anchor"></a><code><span class="keyword">val</span> clear_consts : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Removes all z3 expressions representing constants from the environment. This is used because the initial pass through a binary generates constants that are not used during precondition computation.</p></dd></dl><dl><dt class="spec value" id="val-wp_rec_call"><a href="#val-wp_rec_call" class="anchor"></a><code><span class="keyword">val</span> wp_rec_call : <span><span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> <span>start:Bap.Std.Graphs.Ir.Node.t</span> <span>&#45;&gt;</span> Bap.Std.Graphs.Ir.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>)</span> Stdlib.ref</span></code></dt><dd><p>A reference to <a href="../Precondition/index.html#val-visit_sub"><code>Precondition.visit_sub</code></a> that is needed in the loop handler of the environment simulating &quot;open recursion&quot;.</p></dd></dl><dl><dt class="spec value" id="val-add_var"><a href="#val-add_var" class="anchor"></a><code><span class="keyword">val</span> add_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Add a new binding to the environment for a bap variable to a Z3 expression, typically a constant.</p></dd></dl><dl><dt class="spec value" id="val-remove_var"><a href="#val-remove_var" class="anchor"></a><code><span class="keyword">val</span> remove_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Remove a binding in the environment for a bap variable.</p></dd></dl><dl><dt class="spec value" id="val-find_var"><a href="#val-find_var" class="anchor"></a><code><span class="keyword">val</span> find_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <span><a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> option</span></code></dt><dd><p>Looks up the Z3 variable that represents a BIR variable.</p></dd></dl><dl><dt class="spec value" id="val-add_precond"><a href="#val-add_precond" class="anchor"></a><code><span class="keyword">val</span> add_precond : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Add a precondition to be associated to a block b to the environment.</p></dd></dl><dl><dt class="spec value" id="val-mk_exp_conds"><a href="#val-mk_exp_conds" class="anchor"></a><code><span class="keyword">val</span> mk_exp_conds : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Exp.t <span>&#45;&gt;</span> <span><a href="index.html#type-cond_type">cond_type</a> list</span></code></dt><dd><p>Creates a list of assumptions and verification conditions as hooks on an expression being visited during analysis.</p></dd></dl><dl><dt class="spec value" id="val-get_context"><a href="#val-get_context" class="anchor"></a><code><span class="keyword">val</span> get_context : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Z3.context</code></dt><dd><p>Obtains the Z3 context within a given environment.</p></dd></dl><dl><dt class="spec value" id="val-get_var_gen"><a href="#val-get_var_gen" class="anchor"></a><code><span class="keyword">val</span> get_var_gen : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-var_gen">var_gen</a></code></dt><dd><p>Obtains the var_gen used to create fresh variables within a given environment.</p></dd></dl><dl><dt class="spec value" id="val-get_subs"><a href="#val-get_subs" class="anchor"></a><code><span class="keyword">val</span> get_subs : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>Bap.Std.Sub.t Bap.Std.Seq.t</span></code></dt><dd><p>Obtains the sequence of subroutines that belongs to a BIR program.</p></dd></dl><dl><dt class="spec value" id="val-get_var_map"><a href="#val-get_var_map" class="anchor"></a><code><span class="keyword">val</span> get_var_map : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <a href="index.html#module-EnvMap">EnvMap</a>.t</span></code></dt><dd><p>Obtains the var_map containing a mapping of BIR variables to Z3 variables.</p></dd></dl><dl><dt class="spec value" id="val-get_init_var_map"><a href="#val-get_init_var_map" class="anchor"></a><code><span class="keyword">val</span> get_init_var_map : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <a href="index.html#module-EnvMap">EnvMap</a>.t</span></code></dt><dd><p>Obtains the var_map containing a mapping of BIR variables to the Z3 variables that represent their initial states.</p></dd></dl><dl><dt class="spec value" id="val-get_var"><a href="#val-get_var" class="anchor"></a><code><span class="keyword">val</span> get_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> * <a href="index.html#type-t">t</a></code></dt><dd><p>Looks up the Z3 variable that represents a BIR variable. Produces fresh z3_expr if not found.</p></dd></dl><dl><dt class="spec value" id="val-get_precondition"><a href="#val-get_precondition" class="anchor"></a><code><span class="keyword">val</span> get_precondition : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> <span><a href="../Constraint/index.html#type-t">Constr.t</a> option</span></code></dt><dd><p>Looks up the precondition for a given block in the environment. Currently returns True if the block is not yet visited.</p></dd></dl><dl><dt class="spec value" id="val-get_sub_name"><a href="#val-get_sub_name" class="anchor"></a><code><span class="keyword">val</span> get_sub_name : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>Looks up the subroutine's name given its tid.</p></dd></dl><dl><dt class="spec value" id="val-get_fun_name_tid"><a href="#val-get_fun_name_tid" class="anchor"></a><code><span class="keyword">val</span> get_fun_name_tid : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>Bap.Std.Tid.t option</span></code></dt><dd><p>Finds the tid of a function in the environment.</p></dd></dl><dl><dt class="spec value" id="val-get_called"><a href="#val-get_called" class="anchor"></a><code><span class="keyword">val</span> get_called : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.tid <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>Look up the string name for the variable which represents a call made to a subroutine with a given <code>tid</code>.</p></dd></dl><dl><dt class="spec value" id="val-get_sub_handler"><a href="#val-get_sub_handler" class="anchor"></a><code><span class="keyword">val</span> get_sub_handler : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Tid.t <span>&#45;&gt;</span> <span><a href="index.html#type-fun_spec_type">fun_spec_type</a> option</span></code></dt><dd><p>Looks up the specification of a subroutine that is used to calculate the precondition of a function call.</p></dd></dl><dl><dt class="spec value" id="val-get_indirect_handler"><a href="#val-get_indirect_handler" class="anchor"></a><code><span class="keyword">val</span> get_indirect_handler : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Exp.t <span>&#45;&gt;</span> <a href="index.html#type-indirect_spec">indirect_spec</a></code></dt><dd><p>Looks up the indirect call spec for an expression. Used to calculate the precondition of an indirect call.</p></dd></dl><dl><dt class="spec value" id="val-get_jmp_handler"><a href="#val-get_jmp_handler" class="anchor"></a><code><span class="keyword">val</span> get_jmp_handler : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-jmp_spec">jmp_spec</a></code></dt><dd><p>Looks up the list of jmp_specs that is used to calculate the precondition of jumps in a BIR program.</p></dd></dl><dl><dt class="spec value" id="val-get_int_handler"><a href="#val-get_int_handler" class="anchor"></a><code><span class="keyword">val</span> get_int_handler : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-int_spec">int_spec</a></code></dt><dd><p>Looks up the specification of calculating the precondition of an interrupt.</p></dd></dl><dl><dt class="spec value" id="val-get_loop_handler"><a href="#val-get_loop_handler" class="anchor"></a><code><span class="keyword">val</span> get_loop_handler : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a> <span>&#45;&gt;</span> <span>start:Bap.Std.Graphs.Ir.Node.t</span> <span>&#45;&gt;</span> Bap.Std.Graphs.Ir.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Finds the <a href="index.html#type-loop_handler"><code>loop_handler</code></a> that is used to unroll loops when it is visited in the BIR program.</p></dd></dl><dl><dt class="spec value" id="val-get_arch"><a href="#val-get_arch" class="anchor"></a><code><span class="keyword">val</span> get_arch : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Arch.t</code></dt><dd><p>Obtains the architecture of the program.</p></dd></dl><dl><dt class="spec value" id="val-get_consts"><a href="#val-get_consts" class="anchor"></a><code><span class="keyword">val</span> get_consts : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#module-ExprSet">ExprSet</a>.t</code></dt><dd><p>Obtains a list of all the <a href="../Constraint/index.html#type-z3_expr"><code>Constr.z3_expr</code></a>s that represents constants that were generated during analysis.</p></dd></dl><dl><dt class="spec value" id="val-fold_fun_tids"><a href="#val-fold_fun_tids" class="anchor"></a><code><span class="keyword">val</span> fold_fun_tids : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>init:<span class="type-var">'a</span></span> <span>&#45;&gt;</span> <span>f:<span>(<span>key:string</span> <span>&#45;&gt;</span> <span>data:Bap.Std.Tid.t</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Performs a fold on the map of of function names to tids to generate a <a href="../Constraint/index.html#type-z3_expr"><code>Constr.z3_expr</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-is_x86"><a href="#val-is_x86" class="anchor"></a><code><span class="keyword">val</span> is_x86 : Bap.Std.Arch.t <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks if the architecture is part of the x86 family.</p></dd></dl><dl><dt class="spec value" id="val-use_input_regs"><a href="#val-use_input_regs" class="anchor"></a><code><span class="keyword">val</span> use_input_regs : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks to see if the environment supports using all possible input registers when generating symbols in the function specs at a function call site.</p></dd></dl><dl><dt class="spec value" id="val-in_stack"><a href="#val-in_stack" class="anchor"></a><code><span class="keyword">val</span> in_stack : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></dt><dd><p><code>in_stack env addr</code> is the constraint <code>STACK_MIN &lt; addr &lt;= STACK_MAX</code> as defined by the concrete range of the stack in the env.</p></dd></dl><dl><dt class="spec value" id="val-in_data_section"><a href="#val-in_data_section" class="anchor"></a><code><span class="keyword">val</span> in_data_section : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></dt><dd><p><code>in_data_section env addr</code> is the constraint <code>DATA_MIN &lt;= addr &lt; DATA_MAX</code> as defined by the concrete range of the data section in the env.</p></dd></dl><dl><dt class="spec value" id="val-init_stack_ptr"><a href="#val-init_stack_ptr" class="anchor"></a><code><span class="keyword">val</span> init_stack_ptr : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></dt><dd><p><code>init_stack_ptr env ptr</code> initializes the constraint <code>STACK_MIN + 128 &lt; sp &lt;= STACK_MAX</code> which is the region of the stack that the stack pointer may point to at the beginning of a subroutine. The 128 is based off of the 128 bytes of red zone underneath the stack pointer in x86_64.</p></dd></dl><dl><dt class="spec value" id="val-update_stack_base"><a href="#val-update_stack_base" class="anchor"></a><code><span class="keyword">val</span> update_stack_base : <a href="index.html#type-mem_range">mem_range</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-mem_range">mem_range</a></code></dt><dd><p><code>update_stack_base range base</code> updates the highest address of the stack to be the same value as base.</p></dd></dl><dl><dt class="spec value" id="val-update_stack_size"><a href="#val-update_stack_size" class="anchor"></a><code><span class="keyword">val</span> update_stack_size : <a href="index.html#type-mem_range">mem_range</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-mem_range">mem_range</a></code></dt><dd><p><code>update_stack_size range size</code> updates the size of the stack to be the same value as size.</p></dd></dl><dl><dt class="spec value" id="val-mk_init_var"><a href="#val-mk_init_var" class="anchor"></a><code><span class="keyword">val</span> mk_init_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> * <a href="index.html#type-t">t</a></code></dt><dd><p><code>mk_init_var env var</code> creates a fresh Z3 variable that represents the initial state of variable <code>var</code>. Adds a new binding to <code>env</code> for the bap variable to is generated init variable.</p></dd></dl><dl><dt class="spec value" id="val-get_init_var"><a href="#val-get_init_var" class="anchor"></a><code><span class="keyword">val</span> get_init_var : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Var.t <span>&#45;&gt;</span> <span><a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a> option</span></code></dt><dd><p><code>get_init_var var</code> obtains the Z3 expression that represents the initial state of a bap variable <code>var</code>.</p></dd></dl><dl><dt class="spec value" id="val-trivial_constr"><a href="#val-trivial_constr" class="anchor"></a><code><span class="keyword">val</span> trivial_constr : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-t">Constr.t</a></code></dt><dd><p><code>trivial_constr</code> generates a trivial constraint of just <code>true</code>.</p></dd></dl><dl><dt class="spec value" id="val-mk_z3_expr"><a href="#val-mk_z3_expr" class="anchor"></a><code><span class="keyword">val</span> mk_z3_expr : Z3.context <span>&#45;&gt;</span> <span>name:string</span> <span>&#45;&gt;</span> <span>typ:Bap.Std.Type.t</span> <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></dt><dd><p>Create a constant Z3 expression of a type that corresponds to a bap type, where the correspondence is as follows:</p><ul><li>BitVector of width <code>w</code> -&gt; BitVector of width <code>w</code></li><li>Memory value with address size <code>a</code> and word size <code>w</code> -&gt; Functional array from BitVector <code>a</code> to BitVector <code>w</code>.</li></ul></dd></dl><dl><dt class="spec value" id="val-new_z3_expr"><a href="#val-new_z3_expr" class="anchor"></a><code><span class="keyword">val</span> new_z3_expr : <span>?&#8288;name:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bap.Std.Type.t <span>&#45;&gt;</span> <a href="../Constraint/index.html#type-z3_expr">Constr.z3_expr</a></code></dt><dd><p>Create a Z3 constant of the appropriate name and type, but ensure that the constant is &quot;fresh&quot; with the <a href="index.html#type-var_gen"><code>Environment.var_gen</code></a>.</p></dd></dl></div></body></html>